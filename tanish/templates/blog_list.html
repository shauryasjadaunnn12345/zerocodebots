{% extends "home.html" %}
{% load static %}

{% block title %}Blog – ZeroCodeBots{% endblock %}

{% block breadcrumbs %}
<link rel="canonical" href="https://zerocodebots.com/blog/">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://zerocodebots.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "https://zerocodebots.com/blog/"
    }
  ]
}
</script>
{% endblock breadcrumbs %}
{% block style %}
  <link rel="stylesheet" href="{% static 'css/blog.css' %}">
{% endblock style %}
{% block body %}

<!-- BLOG HERO -->
<section class="blog-hero">
  <div class="container">
    <h1>ZeroCodeBots Blog</h1>
    <p>Explore insights, tips, and stories about no-code automation, AI, and technology</p>
  </div>
</section>

<!-- BLOG LIST -->
<section class="blog-section">
  <div class="container">

    <!-- SEARCH + FILTER -->
    <div class="blog-controls">

      <form method="get" class="search-box">
        <input
          type="text"
          name="search"
          placeholder="Search blogs..."
          value="{{ search_query|default:'' }}"
        >
      </form>

      <div class="category-filter">
        <form method="get" style="display: contents;">
          <button type="submit"
                  name="category"
                  value="all"
                  class="category-btn {% if not selected_category or selected_category == 'all' %}active{% endif %}">
            All
          </button>

          {% for category in categories %}
            <button type="submit"
                    name="category"
                    value="{{ category }}"
                    class="category-btn {% if selected_category == category %}active{% endif %}">
              {{ category }}
            </button>
          {% endfor %}
        </form>
      </div>

      {% if user.is_authenticated %}
        <a href="{% url 'create_blog' %}" class="btn btn-primary create-blog-btn">
          <i class="fas fa-plus"></i> Create Blog
        </a>
      {% endif %}
    </div>

    <!-- BLOG GRID -->
    {% if blogs %}
      <div class="blog-grid">
        {% for blog in blogs %}
          <article class="blog-card">

            <div class="blog-image">
              {% if blog.featured_image %}
                <img src="{{ blog.featured_image.url }}" alt="{{ blog.title }}"
                     loading="lazy" decoding="async"
                     {% if blog.featured_image.width %}width="{{ blog.featured_image.width }}"{% endif %}
                     {% if blog.featured_image.height %}height="{{ blog.featured_image.height }}"{% endif %}
                     fetchpriority="low">
              {% else %}
                <div class="blog-image-placeholder">
                  <i class="fas fa-image"></i>
                </div>
              {% endif %}
            </div>

            <div class="blog-content">
              <span class="blog-category">{{ blog.category }}</span>

              <h3 class="blog-title">
                <a href="{% url 'blog_detail' blog.slug %}">
                  {{ blog.title }}
                </a>
              </h3>

              <p class="blog-excerpt">
                {{ blog.excerpt|truncatewords:15 }}
              </p>

              <div class="blog-meta">
                <div class="blog-author">
                  <i class="fas fa-user-circle"></i>
                  <span>{{ blog.author.username }}</span>
                </div>
                <div class="blog-date">
                  <i class="fas fa-calendar"></i>
                  <span>{{ blog.created_at|date:"M d, Y" }}</span>
                </div>
              </div>

              <a href="{% url 'blog_detail' blog.slug %}" class="blog-read-more">
                Read More <i class="fas fa-arrow-right"></i>
              </a>
            </div>
          </article>
        {% endfor %}
      </div>

      <!-- PAGINATION -->
      {% if page_obj.has_other_pages %}
        <div class="pagination">
          {% if page_obj.has_previous %}
            <a href="?page=1">« First</a>
            <a href="?page={{ page_obj.previous_page_number }}">‹ Prev</a>
          {% endif %}

          {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
              <span class="current">{{ num }}</span>
            {% else %}
              <a href="?page={{ num }}">{{ num }}</a>
            {% endif %}
          {% endfor %}

          {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">Next ›</a>
            <a href="?page={{ page_obj.paginator.num_pages }}">Last »</a>
          {% endif %}
        </div>
      {% endif %}

    {% else %}
      <div class="no-blogs">
        <i class="fas fa-inbox"></i>
        <p>No blogs found. Check back soon!</p>
      </div>
    {% endif %}

  </div>
</section>

{% endblock body %}
